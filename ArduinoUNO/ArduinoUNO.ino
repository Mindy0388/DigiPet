#include <SPI.h>
#include <Wire.h>
#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>


//AD8232
#define ECG_ANALOG = 1

//TTP223B Capative Touch Sensor
#define TOUCH_PIN = 2

// Screen dimensions
#define SCREEN_WIDTH  128
#define SCREEN_HEIGHT 64

// Declaration for SSD1306 display connected using software SPIï¼š
#define OLED_D0    18  // SCLK (SPI Clock)
#define OLED_D1    23  // MOSI (SPI Data)
#define OLED_RES   4   // Reset
#define OLED_DC    2   // Data/Command
#define OLED_CS    5   // Chip Select

// Initialize SSD1306 with SPI
Adafruit_SSD1306 display(
  SCREEN_WIDTH, SCREEN_HEIGHT,
  OLED_D1, OLED_D0, OLED_DC, OLED_RES, OLED_CS
);

//MPU6050 Gyroscope
//Adafruit_MPU6050 mpu



enum PetState { IDLE, HAPPY };
//PetState currentState = IDLE;
bool isPetted = false;

//Bitmaps
const unsigned char idlePet[] PROGMEM = {};
const unsigned char happyPet[] PROGMEM = {};

// TEST bitmap data
const unsigned char testBitmap[] PROGMEM = {
  0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b01111111, 0b11000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000011, 0b11111111, 0b11111100, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00001111, 0b11100000, 0b11111111, 0b10000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00011111, 0b00000000, 0b00001111, 0b11100000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000001, 0b10000000, 
0b00000000, 0b00000000, 0b00011100, 0b00000000, 0b00000001, 0b11110000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000011, 0b11000000, 
0b00000000, 0b00000000, 0b00011001, 0b11111110, 0b00000000, 0b01111100, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000111, 0b11000000, 
0b00000000, 0b00000000, 0b00011111, 0b11111111, 0b11100000, 0b00111110, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00001111, 0b11100000, 
0b00000000, 0b00000000, 0b00011111, 0b10000111, 0b11111000, 0b00001111, 0b10000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00001110, 0b01110000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b01111110, 0b00000111, 0b11000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000011, 0b10000000, 0b00000000, 0b00011100, 0b01110000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00011111, 0b10000001, 0b11100000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000011, 0b11100000, 0b00000000, 0b00111100, 0b00110000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000111, 0b11000000, 0b11110000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000111, 0b11110000, 0b00000000, 0b00111000, 0b00111000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000001, 0b11110000, 0b01111000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000111, 0b01111000, 0b00000000, 0b01110000, 0b00111000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b11111000, 0b00111100, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000110, 0b00111100, 0b00000000, 0b11110000, 0b00011100, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00111100, 0b00011110, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00001110, 0b00011110, 0b00000000, 0b11100000, 0b00011100, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00011110, 0b00001110, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00001110, 0b00001110, 0b00111111, 0b11100000, 0b00001110, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00001110, 0b00000111, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00001100, 0b00000111, 0b11111111, 0b11100000, 0b00001110, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000111, 0b00000111, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00001100, 0b00000111, 0b11110000, 0b00000000, 0b00001110, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000111, 0b10000011, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00011100, 0b00000011, 0b00000000, 0b00000000, 0b00001110, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000011, 0b10000011, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00011100, 0b00000000, 0b00000000, 0b00000000, 0b00000111, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000001, 0b11000011, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00011000, 0b00000000, 0b00000000, 0b00000000, 0b00000111, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b11000011, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00011000, 0b00000000, 0b00000000, 0b00000000, 0b00000011, 
0b10000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b11000011, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00011000, 0b00000000, 0b00000000, 0b00000000, 0b00000011, 
0b10000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b11000011, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00011100, 0b00000000, 0b00000000, 0b00000000, 0b00000001, 
0b11000000, 0b00000000, 0b00000001, 0b11111000, 0b00000000, 0b00000000, 0b11000011, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00011100, 0b00000000, 0b00000000, 0b00011000, 0b00000001, 
0b11100000, 0b00000000, 0b00001111, 0b11111111, 0b10000000, 0b00000000, 0b11000111, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00111100, 0b00000000, 0b00000000, 0b00011000, 0b00000000, 
0b11100000, 0b00000000, 0b01111111, 0b10011111, 0b11110000, 0b00000001, 0b11000111, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00111000, 0b00000110, 0b00000000, 0b00000000, 0b00000000, 
0b01100011, 0b11111111, 0b11111100, 0b00000001, 0b11111100, 0b00000011, 0b11001110, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00000110, 0b00000000, 0b00000000, 0b00000000, 
0b01111111, 0b11111111, 0b11100000, 0b00000000, 0b00111111, 0b00000111, 0b10001110, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b01111111, 0b00000000, 0b00000000, 0b00000000, 0b00001111, 0b10001111, 0b00011100, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b01111000, 0b00000000, 0b00000000, 0b00000000, 0b00001111, 0b11111110, 0b00111100, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00000000, 0b00000110, 0b00000000, 0b00000000, 
0b01100000, 0b00000000, 0b00000000, 0b00000000, 0b00001111, 0b11111100, 0b01111000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00000000, 0b00000110, 0b00000000, 0b00000000, 
0b01100000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b11110000, 0b01110000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00000000, 0b00001111, 0b10000000, 0b00000000, 
0b01100000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b01110000, 0b11100000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00000000, 0b00001111, 0b11110000, 0b00000000, 
0b11100000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00111001, 0b11100000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00111000, 0b00000000, 0b00111101, 0b11110000, 0b00000000, 
0b11100000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00111111, 0b11000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00111100, 0b00000000, 0b00111100, 0b00000000, 0b00000001, 
0b11000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00011111, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00011100, 0b00000000, 0b00000000, 0b00000000, 0b00000011, 
0b11000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00011110, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000011, 
0b10000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00011100, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00011000, 0b00000000, 0b00000000, 0b00000000, 0b00000011, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00011000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00111000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00011000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00111000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00011000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b01110000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00011000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b11100000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00000000, 0b00011000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000001, 0b11100000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00000000, 0b00011000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000011, 0b11000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b01110000, 0b00000000, 0b00111000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000111, 0b10000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b01110000, 0b00000000, 0b00111000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00001111, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b01100000, 0b00000000, 0b01110000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00011110, 0b00000011, 0b11111111, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b11100000, 0b00000000, 0b01110000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00011100, 0b00001111, 0b11111111, 0b11111100, 0b00000001, 0b10000000, 
0b00000000, 0b00000000, 0b00000001, 0b11100000, 0b00000000, 0b11100000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00111000, 0b01111111, 0b00000011, 0b11111111, 0b11111111, 0b10000000, 
0b00000000, 0b00000000, 0b00111111, 0b11100000, 0b00000011, 0b11100000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b01111001, 0b11111100, 0b00000000, 0b00001111, 0b11111111, 0b10000000, 
0b00000000, 0b00011111, 0b11111111, 0b11000000, 0b00000111, 0b11000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b01111111, 0b11100000, 0b00000000, 0b00000000, 0b00011110, 0b00000000, 
0b00111111, 0b11111111, 0b11110011, 0b10000000, 0b00011111, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b01111111, 0b10000000, 0b00000000, 0b00000000, 0b00111100, 0b00000000, 
0b11111111, 0b11111000, 0b00000011, 0b10000000, 0b00111110, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b01111000, 0b00000000, 
0b11111110, 0b00000000, 0b00000011, 0b00000001, 0b11111000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b11110000, 0b00000000, 
0b11110000, 0b00000000, 0b00000111, 0b00000111, 0b11110000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000001, 0b11100000, 0b00000000, 
0b11100000, 0b00000000, 0b00000111, 0b01111111, 0b10000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000001, 0b11111111, 0b11111111, 
0b11000000, 0b00000000, 0b00000111, 0b11111110, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000001, 0b11111111, 0b11111111, 
0b10000000, 0b00000000, 0b00000111, 0b11100000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 
0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000
};

//The setup function
void setup() {
  Serial.begin(9600);

  // SSD1306_SWITCHCAPVCC = generate display voltage from 3.3V internally
  if(!display.begin(SSD1306_SWITCHCAPVCC)) {
    Serial.println(F("SSD1306 allocation failed"));
    for(;;); // Don't proceed, loop forever
  }

  // Display bitmap
  display.clearDisplay();
  display.drawBitmap(0, 0, testBitmap, 128, 64, 1);
  display.display();
}

void loop() {
  // Nothing here (static display)
}